var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},ELang;(function(n){var r=function(){function n(){this.select=new jQuery.Deferred}return n}(),t,i,u;n.ELangSearchEvents=r,t=function(){function n(){this.selectCallback=null,this.selectHandler=null,this.langDirectionHandler=null,this.langDirectionClickHandler=null,this.searchHandler=null,this.searchClickHandler=null}return n}(),n.ELangSearchDelegates=t,i=function(n){function t(){n.call(this),this.headLabel="lblFindHead",this.resultHeadLabel="lblFindedExpressionsHead",this.directionExpressionsLabel="lblSearchInExpressions",this.directionMeaningsLabel="lblSearchInMeanings",this.searchFormHtml='<form class="form-search"><div class="input-append"><\/div><\/form>',this.searchFieldHtml='<input type="text" class="search-query" />',this.searchButtonHtml='<button type="submit" class="btn"><span><\/span><\/button>',this.searchButtonLabel="lblFind"}return __extends(t,n),t}(n.ELangBaseDefaults),n.ELangSearchDefaults=i,u=function(u){function f(){u.call(this),this.name="eLang-Search",this.description="eLang - Language Learning search functionality.",this.defaults=new i,this.delegates=new t,this.events=new r,this.isSearchInExp=!0}return __extends(f,u),f.prototype.initialize=function(n,t){u.prototype.initialize.call(this,n,t),this.delegates.selectHandler=jQuery.proxy(this._onSelect,this),this.delegates.selectCallback=jQuery.proxy(this._onSelectCallback,this),this.delegates.langDirectionHandler=jQuery.proxy(this._onDirectionClick,this),this.delegates.searchHandler=jQuery.proxy(this._select,this),this.events.select.done(this.delegates.selectHandler);var i=this.delegates.langDirectionHandler,r=this.delegates.searchHandler;this.delegates.searchClickHandler=function(){var n=this,t=n.parentNode.getElementsByTagName("input")[0];r(t)},this.delegates.langDirectionClickHandler=function(){var n=this;i(n)},this.createContent(),this.element.data("elang-search",jQuery.proxy(this.processCommand,this))},f.prototype.createContent=function(){u.prototype.createContent.call(this);var e=this.element.next("div"),l="."+this.defaults.resultCSS.split(" ")[0],o=e.find("*").filter(l),i=jQuery(this.defaults.radioGroupHtml),t=jQuery(this.defaults.radioButtonHtml),r=jQuery(this.defaults.radioButtonHtml),s=this.getLastChild(i);t.add(t.find("*")).filter("span").attr("id",this.defaults.directionExpressionsLabel),r.add(r.find("*")).filter("span").attr("id",this.defaults.directionMeaningsLabel),t.click(this.delegates.langDirectionClickHandler),r.click(this.delegates.langDirectionClickHandler),s.append(t),s.append(r),o.before(i),n.ELangCommon.setLang(n.ELangCommon.resource.selectedLang,i),i.button(),t.click();var h=jQuery(this.defaults.searchFormHtml),a=jQuery(this.defaults.searchFieldHtml),f=jQuery(this.defaults.searchButtonHtml),c=this.getLastChild(h);f.add(f.find("*")).filter("span").attr("id",this.defaults.searchButtonLabel),f.click(this.delegates.searchClickHandler),c.append(a),c.append(f),o.before(h),n.ELangCommon.setLang(n.ELangCommon.resource.selectedLang,e)},f.prototype._onDirectionClick=function(n){var t=jQuery(n),i=t.add(t.find("*")).filter("span[id]").attr("id");this.isSearchInExp=i==this.defaults.directionExpressionsLabel},f.prototype._onSelect=function(t){var i=t.value,r;i?(r=n.ELangDB.getInstance(),r.select(i,this.delegates.selectCallback)):this._onSelectCallback()},f.prototype._onSelectCallback=function(){},f.prototype._select=function(n){this.events.select.resolve(n)},f}(n.ELangBase),n.ELangSearch=u})(ELang||(ELang={})),function(n){n.fn.elangSearch=function(t,i){for(var f=this,e,u,o,r=0;r<f.length;r++)if(e=f[r],u=e["elang-search"],i&&typeof i=="string"?n.isFunction(u)&&u(i):u||(o=new ELang.ELangSearch,o.initialize(e,t)),!0)break;return f}}(jQuery)